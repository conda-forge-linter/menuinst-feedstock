From 7418afc7d58475ca997a9347cea393be0bbb4bbb Mon Sep 17 00:00:00 2001
From: Isuru Fernando <isuruf@gmail.com>
Date: Mon, 15 Aug 2022 09:57:57 -0500
Subject: [PATCH] Fix exceptions for pywin32 removal

---
 menuinst/__init__.py | 3 +--
 menuinst/win32.py    | 3 +--
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/menuinst/__init__.py b/menuinst/__init__.py
index ccdd239c..1dad2af5 100644
--- a/menuinst/__init__.py
+++ b/menuinst/__init__.py
@@ -60,14 +60,13 @@ def install(path, remove=False, prefix=sys.prefix, recursing=False, root_prefix=
         if isUserAdmin():
             _install(path, remove, prefix, mode='system', root_prefix=root_prefix)
         else:
-            from pywintypes import error
             retcode = 1
             try:
                 if not recursing:
                     retcode = runAsAdmin([join(root_prefix, 'python'), '-c',
                                           "import menuinst; menuinst.install(%r, %r, %r, %r, %r)" % (
                                               path, bool(remove), prefix, True, root_prefix)])
-            except error:
+            except WindowsError:
                 pass
 
             if retcode != 0:
diff --git a/menuinst/win32.py b/menuinst/win32.py
index de471b28..6aabd933 100644
--- a/menuinst/win32.py
+++ b/menuinst/win32.py
@@ -8,7 +8,6 @@
 import logging
 import os
 from os.path import isdir, join, exists, split
-import pywintypes
 import sys
 import locale
 
@@ -202,7 +201,7 @@ def __init__(self, name, prefix=unicode_root_prefix, env_name=u"", mode=None, ro
                     % (name, self.prefix, env_name, mode, used_mode, root_prefix))
         try:
             self.set_dir(name, self.prefix, env_name, used_mode, root_prefix)
-        except (WindowsError, pywintypes.error):
+        except WindowsError:
             # We get here if we aren't elevated.  This is different from
             #   permissions: a user can have permission, but elevation is still
             #   required.  If the process isn't elevated, we get the
